/*

 */

/* --- GLOBAL RESET & BASE STYLES --- */
* {
    border: none;
    border-radius: 0;
    box-sizing: border-box;
    min-height: 0;
    padding: 0;
    margin: 0;
    font-family: sans-serif;
    font-size: 14px;
    font-weight: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
}
*::before,
*::after {
    box-sizing: inherit;
}

/* --- WAYBAR MAIN STYLING & CSS VARIABLES --- */
window#waybar {
    /*
     * ==========================================================================
     * --- CORE THEME CONFIGURATION ---
     * ==========================================================================

    --enable-shadows-master: 1;
    --enable-gradients-master: 1;
    --enable-animations-master: 1;
    --enable-animated-bar-border: 1;
    --enable-dynamic-workspace-accents: 1;
    --enable-subtle-noise-texture: 0;
    --enable-experimental-glassmorphism: 0;
    --enable-high-contrast-focus-outline: 0;


    /* --- Font Stack Configuration --- */
    --font-stack-ui: "Inter", "Noto Sans", "Cantarell", "Ubuntu", sans-serif;
    --font-stack-mono: "JetBrainsMono Nerd Font", "Fira Code", "Hack", monospace;
    --font-stack-icons: "Font Awesome 6 Free Solid", "Material Design Icons", "JetBrainsMono Nerd Font";

    /*
     * ==========================================================================

     * ==========================================================================
     */

    /* --- Minimalist Override Logic --- */


    /* --- Effective Toggles --- */
    --_effective-shadows-enabled: calc(var(--enable-shadows-master) * (1 - var(--_minimal-mode-active)));
    --_effective-gradients-enabled: calc(var(--enable-gradients-master) * (1 - var(--_minimal-mode-active)));
    --_effective-cosmetic-animations-enabled: calc(var(--enable-animations-master) * (1 - var(--_minimal-mode-active)));
    --_effective-animated-bar-border-enabled: calc(var(--enable-animated-bar-border) * var(--_effective-cosmetic-animations-enabled));
    --_effective-dynamic-ws-accents-enabled: calc(var(--enable-dynamic-workspace-accents) * var(--_effective-cosmetic-animations-enabled));
    --_effective-noise-texture-enabled: calc(var(--enable-subtle-noise-texture) * (1 - var(--_minimal-mode-active)));
    --_effective-glassmorphism-enabled: calc(var(--enable-experimental-glassmorphism) * (1 - var(--_minimal-mode-active)));

    /* --- Effects Detail Adjustments --- */


    /* --- Base Color Palette --- */
    --L-bg-primary: calc(var(--cfg-base-theme-mode) * 96% + (1 - var(--cfg-base-theme-mode)) * 4%);
    --L-bg-secondary: calc(var(--cfg-base-theme-mode) * 92% + (1 - var(--cfg-base-theme-mode)) * 8%);
    --L-bg-tertiary: calc(var(--cfg-base-theme-mode) * 88% + (1 - var(--cfg-base-theme-mode)) * 12%);
    --L-fg-primary: calc(var(--cfg-base-theme-mode) * 8% + (1 - var(--cfg-base-theme-mode)) * 92%);
    --L-fg-secondary: calc(var(--cfg-base-theme-mode) * 25% + (1 - var(--cfg-base-theme-mode)) * 75%);
    --L-fg-tertiary: calc(var(--cfg-base-theme-mode) * 45% + (1 - var(--cfg-base-theme-mode)) * 55%);
    --L-border-default: calc(var(--cfg-base-theme-mode) * 85% + (1 - var(--cfg-base-theme-mode)) * 18%);

    --theme-bg-primary: hsl(0, 0%, var(--L-bg-primary));
    --theme-bg-secondary: hsl(0, 0%, var(--L-bg-secondary));
    --theme-bg-tertiary: hsl(0, 0%, var(--L-bg-tertiary));
    --theme-fg-primary: hsl(0, 0%, var(--L-fg-primary));
    --theme-fg-secondary: hsl(0, 0%, var(--L-fg-secondary));
    --theme-fg-tertiary: hsl(0, 0%, var(--L-fg-tertiary));
    --theme-border-default: hsl(0, 0%, var(--L-border-default));



    --accent-H: var(--accent-H-resolved);
    --accent-S: var(--accent-S-resolved);
    --accent-L-base: var(--accent-L-base-resolved);

    --accent-L-darker: calc(var(--accent-L-base) - (12% * (1 - var(--_is-palette-monochrome))));
    --accent-L-lighter: calc(var(--accent-L-base) + (12% * (1 - var(--_is-palette-monochrome))));
    --accent-L-highlight: calc(var(--accent-L-base) + (18% * (1 - var(--_is-palette-monochrome))));

    --theme-accent-primary-base: hsl(var(--accent-H), var(--accent-S), var(--accent-L-base));
    --theme-accent-primary-grad-start: hsl(var(--accent-H), var(--accent-S), var(--accent-L-lighter));
    --theme-accent-primary-grad-end: hsl(var(--accent-H), var(--accent-S), var(--accent-L-darker));
    --theme-accent-secondary-base: hsl(var(--accent-H), calc(var(--accent-S) * 0.9), var(--accent-L-darker));
    --theme-accent-highlight: hsl(var(--accent-H), var(--accent-S), var(--accent-L-highlight));

    /* --- Spacing & Sizing --- */
    --_density-scale-factor: var(--cfg-density-scale);
    --spacing-unit: calc(4px * var(--_density-scale-factor));
    --radius-unit: calc(6px * var(--_density-scale-factor));


    --_animation-speed-multiplier: calc(1 - (var(--_is-visual-profile-standard) * 0.3) - (var(--_minimal-mode-active) * 0.7));
    --_transform-intensity-multiplier: calc(1 + (var(--_is-visual-profile-enhanced) * 0.3) - (var(--_minimal-mode-active) * 0.8));
    --_effective-border-style: solid;
    --_border-radius-multiplier: calc(1 - (var(--_is-visual-profile-standard) * 0.3) + (var(--_is-visual-profile-enhanced) * 0.2) - (var(--_minimal-mode-active) * 0.5));


    /* --- Core Palette & Accents --- */
    --color-background-bar: var(--theme-bg-primary);
    --color-text-bar-default: var(--theme-fg-primary);
    --color-accent-primary-gradient: linear-gradient(calc(135deg + var(--_is-visual-profile-enhanced) * 20deg), var(--theme-accent-primary-grad-start) 0%, var(--theme-accent-primary-base) 50%, var(--theme-accent-primary-grad-end) 100%);

    --color-accent-primary-solid: var(--theme-accent-primary-base);
    --color-accent-secondary: var(--theme-accent-secondary-base);
    --color-accent-highlight: var(--theme-accent-highlight);

    /* --- UI Element Colors --- */
    --color-background-module-default: var(--theme-bg-secondary);
    --color-background-module-alternate: var(--theme-bg-tertiary);
    --color-border-module-default: var(--theme-border-default);

    --color-background-module-hover: var(--theme-bg-tertiary);
    --color-text-module-hover: var(--theme-fg-primary);
    --color-border-module-hover: var(--color-accent-highlight);

    --color-background-module-active: var(--color-accent-secondary);
    --color-text-module-active: var(--theme-fg-primary);
    --color-border-module-active: var(--color-accent-primary-solid);

    /* --- Typography --- */
    --typography-font-family-main: var(--font-stack-ui);
    --typography-font-family-monospace: var(--font-stack-mono);
    --typography-font-family-icons: var(--font-stack-icons);
    --typography-font-variant-numeric: tabular-nums;
    --typography-font-feature-settings: "liga" 1, "clig" 1;
    --theme-font-size-base: 14px;
    --typography-font-size-default: calc(var(--theme-font-size-base) * var(--_density-scale-factor));
    --typography-font-size-small: calc(var(--typography-font-size-default) * 0.85);
    --typography-font-size-large: calc(var(--typography-font-size-default) * 1.15);
    --typography-font-weight-normal: 400;
    --typography-font-weight-medium: 500;
    --typography-font-weight-bold: calc(600 + var(--_is-visual-profile-enhanced) * 100);
    --typography-letter-spacing-normal: normal;
    --typography-text-shadow-subtle: 1px 1px 2px hsla(0, 0%, 0%, calc(0.1 * var(--_effective-shadows-enabled) * var(--_effects-detail-multiplier-reduced)));
    --typography-text-shadow-header: 0 1px 3px hsla(0, 0%, 0%, calc(0.15 * var(--_effective-shadows-enabled) * var(--_effects-detail-multiplier-reduced)));

    /* --- Dimensions & Spacing --- */
    --dimension-bar-border-height: calc(3px * var(--_density-scale-factor));
    --dimension-module-padding-vertical: calc(var(--spacing-unit) * 1.25);
    --dimension-module-padding-horizontal: calc(var(--spacing-unit) * 2.5);
    --dimension-module-margin-vertical: var(--spacing-unit);
    --dimension-module-margin-horizontal: calc(var(--spacing-unit) * 1.25);
    --dimension-radius-base: calc(var(--radius-unit) * var(--_border-radius-multiplier));
    --dimension-radius-module: var(--dimension-radius-base);
    --dimension-radius-button: calc(var(--dimension-radius-base) * 0.8);
    --dimension-radius-tooltip: var(--dimension-radius-base);
    --dimension-border-width-thin: 1px;
    --dimension-border-width-normal: 2px;
    --dimension-border-style-default: var(--_effective-border-style);

    /* --- Transitions & Animations --- */
    --transition-duration-base: calc(0.2s * var(--_animation-speed-multiplier) * var(--_effects-duration-scale));
    --transition-duration-fast: calc(var(--transition-duration-base) * 0.6);
    --transition-duration-normal: var(--transition-duration-base);
    --transition-duration-slow: calc(var(--transition-duration-base) * 1.5);

    --transition-timing-function-standard: cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --transition-timing-function-enhanced: cubic-bezier(0.34, 1.56, 0.64, 1);


    --transition-properties-common: background, color, border-color, opacity, box-shadow, transform, filter;

    /* --- Interaction Feedback --- */
    --_transform-scale-factor: calc(0.03 * var(--_transform-intensity-multiplier));
    --interaction-transform-hover-lift-actual: translateY(calc(-2px * var(--_transform-intensity-multiplier) * var(--_effective-cosmetic-animations-enabled)));
    --interaction-transform-hover-scale-actual: scale(calc(1 + var(--_transform-scale-factor) * var(--_effective-cosmetic-animations-enabled)));
    --interaction-transform-active-press: scale(calc(0.97 * (1 - var(--_transform-scale-factor) / 2)));

    /* --- Effects: Shadows, Focus, Glow --- */
    --_shadow-opacity-base: calc(0.1 * var(--_effective-shadows-enabled) * var(--_effects-detail-multiplier-reduced));
    --_shadow-L-offset: calc(var(--cfg-base-theme-mode) * 20% + (1 - var(--cfg-base-theme-mode)) * 0%);
    --effects-shadow-color-ambient: hsla(0, 0%, var(--_shadow-L-offset), calc(var(--_shadow-opacity-base) * 0.8));
    --effects-shadow-color-direct: hsla(0, 0%, var(--_shadow-L-offset), calc(var(--_shadow-opacity-base) * 1.2));
    --effects-shadow-module-actual: 0 2px 5px -1px var(--effects-shadow-color-ambient), 0 4px 8px -2px var(--effects-shadow-color-direct);
    --effects-shadow-module-hover-actual: 0 5px 10px -2px var(--effects-shadow-color-ambient), 0 8px 16px -3px var(--effects-shadow-color-direct);
    --effects-shadow-tooltip-actual: 0 8px 24px -4px var(--effects-shadow-color-direct);
    --effects-shadow-inner-pressed: inset 0 2px 4px hsla(0, 0%, var(--_shadow-L-offset), 0.2);

    --effects-focus-ring-color: var(--color-accent-highlight);


    --effects-glow-color-actual: hsla(var(--accent-H), var(--accent-S), calc(var(--accent-L-base) + 8%), calc(0.35 * var(--_effective-cosmetic-animations-enabled) * var(--_effects-detail-multiplier-reduced)));
    --effects-glow-focused-actual: 0 0 15px 3px var(--effects-glow-color-actual);

    /* --- Animations --- */
    --animation-name-bar-border-sweep: bar-border-sweep-animation;
    --animation-duration-bar-border-sweep: calc(10s * var(--_animation-speed-multiplier));
    --animation-bar-border-actual: var(--_effective-animated-bar-border-enabled) var(--animation-name-bar-border-sweep) var(--animation-duration-bar-border-sweep) linear infinite;

    --_enable-animation-urgent-pulse: 1;
    --_enable-animation-focused-glow: 1;
    --_enable-animation-state-feedback: 1;

    --animation-name-urgent-pulse: urgent-pulse-animation;
    --animation-duration-pulse: calc(1.4s * var(--_animation-speed-multiplier));
    --animation-urgent-actual: var(--_enable-animation-urgent-pulse) var(--animation-name-urgent-pulse) var(--animation-duration-pulse) ease-in-out infinite alternate;

    --animation-name-focused-glow: focused-glow-animation;
    --animation-duration-glow: calc(2.2s * var(--_animation-speed-multiplier));
    --animation-focused-glow-actual: var(--_enable-animation-focused-glow) var(--animation-name-focused-glow) var(--animation-duration-glow) ease-in-out infinite alternate;

    --animation-name-state-feedback: state-feedback-animation;
    --animation-duration-state-feedback: calc(0.4s * var(--_animation-speed-multiplier));
    --animation-state-feedback-actual: var(--_enable-animation-state-feedback) var(--animation-name-state-feedback) var(--animation-duration-state-feedback) var(--transition-timing-function-ui);

    --animation-name-dynamic-border: dynamic-border-animation;
    --animation-duration-dynamic-border: calc(0.35s * var(--_animation-speed-multiplier));
    --transition-timing-function-snap: ease-out;
    --animation-dynamic-ws-border-actual: var(--_effective-dynamic-ws-accents-enabled) var(--animation-name-dynamic-border) var(--animation-duration-dynamic-border) var(--transition-timing-function-snap, ease-out) forwards;

    /* --- Optional Noise Texture --- */
    --noise-texture-svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'%3E%3Cfilter id='nFT'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23nFT)'/%3E%3C/svg%3E");
    --noise-texture-opacity: calc(0.015 * var(--_effective-noise-texture-enabled));

    /* --- Experimental: Glassmorphism --- */
    --glass-blur-radius-actual: calc(12px * var(--_effective-glassmorphism-enabled));
    --glass-background-color-actual: hsla(0, 0%, calc(var(--cfg-base-theme-mode) * 100% + (1 - var(--cfg-base-theme-mode)) * 20%), calc(0.15 * var(--_effective-glassmorphism-enabled)));

    /* --- Bar Properties --- */
    font-family: var(--typography-font-family-main);
    font-size: var(--typography-font-size-default);
    font-weight: var(--typography-font-weight-normal);
    background: var(--color-background-bar);
    color: var(--color-text-bar-default);
    position: relative;
    border-bottom: none;
}

window#waybar::after { /* Animated border */
    content: ''; position: absolute; left: 0; right: 0; bottom: 0;
    height: var(--dimension-bar-border-height);
    background: linear-gradient(90deg,
        var(--theme-accent-primary-grad-start), var(--theme-accent-highlight),
        var(--theme-accent-primary-base), var(--theme-accent-highlight),
        var(--theme-accent-primary-grad-end), var(--theme-accent-highlight),
        var(--theme-accent-primary-base), var(--theme-accent-highlight),
        var(--theme-accent-primary-grad-start));
    background-size: 400% 100%;
    animation: var(--animation-bar-border-actual);
    z-index: 0; opacity: var(--_effective-animated-bar-border-enabled);
    box-shadow: 0 -2px 8px -2px hsla(var(--accent-H), var(--accent-S), var(--accent-L-base), calc(0.3 * var(--_effective-animated-bar-border-enabled)));
}
window#waybar::before { /* Noise Texture */
    content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-image: var(--noise-texture-svg);
    opacity: var(--noise-texture-opacity);
    pointer-events: none; z-index: -1;
}


:where(#mode, #clock, #battery, #cpu, #memory, #network, #pulseaudio, #tray, #custom-power, #hyprland-window) {
    padding: var(--dimension-module-padding-vertical) var(--dimension-module-padding-horizontal);
    margin: var(--dimension-module-margin-vertical) var(--dimension-module-margin-horizontal);
    color: var(--color-text-bar-default);
    border: var(--dimension-border-width-thin) var(--dimension-border-style-default) var(--color-border-module-default);
    border-radius: var(--dimension-radius-module);
    box-shadow: var(--effects-shadow-module-actual);
    transition-property: var(--transition-properties-common);
    transition-duration: var(--transition-duration-normal);
    /* Conditional timing function via class */
    transition-timing-function: var(--transition-timing-function-standard);
    position: relative; z-index: 1; overflow: hidden;
    -webkit-backdrop-filter: blur(var(--glass-blur-radius-actual));
    backdrop-filter: blur(var(--glass-blur-radius-actual));
    background-color: var(--color-background-module-default); /* Fallback */
    background-color: color-mix(in srgb, var(--color-background-module-default) calc(100% - (90% * var(--_effective-glassmorphism-enabled))), var(--glass-background-color-actual) calc(100% * var(--_effective-glassmorphism-enabled)) );
}

    content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-image: var(--noise-texture-svg); opacity: var(--noise-texture-opacity);
    pointer-events: none; z-index: -1; border-radius: inherit;
}


:is(#clock, #battery, #cpu, #memory, #network, #pulseaudio, #tray):not(.disabled):not(.error):not(.active):hover {
    background: var(--color-background-module-hover);
    color: var(--color-text-module-hover);
    border-color: var(--color-border-module-hover);
    box-shadow: var(--effects-shadow-module-hover-actual);
    transform: var(--interaction-transform-hover-lift-actual) var(--interaction-transform-hover-scale-actual);
    transition-duration: var(--transition-duration-fast);
    z-index: 10;
}
:is(#clock, #battery, #cpu, #memory, #network, #pulseaudio, #tray):not(.disabled):not(.error):focus,
:is(#clock, #battery, #cpu, #memory, #network, #pulseaudio, #tray):not(.disabled):not(.error):focus-within {
    outline: var(--outline-high-contrast-focus-actual);
    border-color: var(--color-accent-highlight);
    box-shadow: var(--effects-shadow-module-hover-actual), var(--effects-focus-ring-shadow-actual);
    animation: var(--animation-focused-glow-actual);
    z-index: 15;
}
:is(#clock, #battery, #cpu, #memory, #network, #pulseaudio, #tray).active:not(.disabled):not(.error) {
    background: var(--color-background-module-active);
    color: var(--color-text-module-active);
    border-color: var(--color-border-module-active);
    box-shadow: var(--effects-shadow-inner-pressed), var(--effects-focus-ring-shadow-actual);
    transform: var(--interaction-transform-active-press);
    animation: var(--animation-state-feedback-actual);
    z-index: 20;
}

    border-color: transparent;
    box-shadow: var(--effects-shadow-module-hover-actual), var(--effects-focus-ring-shadow-actual), var(--effects-glow-focused-actual);
    font-weight: var(--typography-font-weight-bold);
    transform: var(--interaction-transform-hover-scale-actual);
    animation: var(--animation-focused-glow-actual);
    z-index: 5;
}

}
#workspaces button.urgent { color: var(--color-text-urgent, var(--theme-fg-primary)); background: var(--color-background-urgent, var(--theme-accent-secondary-base)); border: var(--dimension-border-width-thin) solid var(--color-border-urgent, var(--theme-accent-highlight)); animation: var(--animation-urgent-actual); font-weight: var(--typography-font-weight-bold); box-shadow: 0 0 10px -2px var(--color-background-urgent, var(--theme-accent-secondary-base)); z-index: 5; }
#workspaces button:hover:not(.focused):not(.urgent) { color: var(--color-text-workspace-hover, var(--color-text-module-hover)); background: var(--color-background-module-hover); transform: var(--interaction-transform-hover-scale-actual) var(--interaction-transform-hover-lift-actual); z-index: 1; }
#workspaces button.visible:hover:not(.focused) { color: var(--color-text-workspace-hover, var(--color-text-module-hover)); background: color-mix(in srgb, var(--color-background-workspace-visible, var(--theme-bg-tertiary)) 60%, var(--color-background-module-hover) 40%); transform: var(--interaction-transform-hover-scale-actual) var(--interaction-transform-hover-lift-actual); z-index: 1; }
#workspaces button.focused:hover {

}
#workspaces button.urgent:hover { color: var(--color-text-urgent, var(--theme-fg-primary)); background: var(--color-background-urgent-hover, var(--color-accent-secondary)); border-color: var(--color-accent-highlight); animation-play-state: paused; transform: var(--interaction-transform-hover-scale-actual); }


#network.disconnected { animation: var(--animation-state-feedback-actual); }
#battery.critical:not(.charging) {
    background: var(--theme-accent-primary-solid); /* Default to solid */
    color: var(--theme-fg-primary);
    font-weight: var(--typography-font-weight-bold); animation: var(--animation-urgent-actual);
}

}

/* Tray */
#tray { padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5); background: var(--color-background-module-alternate); }
#tray > widget { margin: 0 var(--spacing-unit); opacity: 0.75; transition-property: opacity, transform; transition-duration: 0.25s; transition-timing-function: var(--transition-timing-function-standard); filter: drop-shadow(var(--typography-text-shadow-subtle)); }
#tray > widget.visual-profile-enhanced { transition-timing-function: var(--transition-timing-function-enhanced); }
#tray > widget:hover { opacity: 1; transform: scale(1.15) translateY(-1px); }



/* --- END OF STYLESHEET --- */
